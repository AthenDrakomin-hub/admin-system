# 5种交易模式设计文档

## 1. A股常规交易

### 功能特点
- 标准A股买卖交易
- 自动计算佣金、印花税、过户费
- 实时价格验证

### 费用计算
```typescript
佣金 = 交易金额 × 0.03% (最低5元)
印花税 = 交易金额 × 0.1% (仅卖出)
过户费 = 交易金额 × 0.002%
```

### 审核流程
1. 订单提交
2. 价格合理性检查
3. 资金充足性验证
4. 管理员审核
5. 执行成交

---

## 2. 港股交易

### 功能特点
- 支持港币/人民币双币种
- 实时汇率转换
- 汇率波动缓冲机制

### 汇率处理
```typescript
实时汇率: HKD/CNY = 0.92 (动态获取)
汇率缓冲: ±2%
最低佣金: 50 HKD
```

### 审核流程
1. 币种选择
2. 汇率锁定
3. 金额换算
4. 资金验证
5. 管理员审核

---

## 3. 新股申购

### 功能特点
- 资格自动审核
- 中签分配管理
- 冻结资金管理

### 资格要求
```typescript
交易天数: ≥20天
账户余额: ≥申购金额
单次限额: ≤100万元
```

### 审核流程
1. 资格审核（自动）
   - 交易天数检查
   - 余额验证
   - 限额检查
2. 冻结资金
3. 中签结果录入
4. 资金解冻/扣款

---

## 4. 大宗交易

### 功能特点
- 大额整单匹配
- 折扣率控制
- 对手方管理

### 交易规则
```typescript
最低金额: 200万元
最大折扣: 10%
最小成交量: 根据股票设定
```

### 审核流程
1. 金额验证
2. 折扣率检查
3. 对手方匹配
4. 管理员确认
5. 批量成交

---

## 5. 一键打板

### 功能特点
- 涨停价自动下单
- 多级风控体系
- 人工审核机制

### 风控规则
```typescript
每日用户限额: 10万元
自动通过: ≤5万元 (低风险)
自动通过: 5-10万元 (中风险)
人工审核: >10万元 或 连续涨停≥3天 (高风险)
```

### 风险等级
- **低风险**: 金额≤5万，自动通过
- **中风险**: 金额5-10万，自动通过但标记
- **高风险**: 金额>10万或连续涨停≥3天，需人工审核

### 审核流程
1. 涨停价验证
2. 额度检查
3. 风险评级
4. 自动/人工审核
5. 快速成交

---

## 技术实现

### 类型定义
- `types/trade.ts` - 5种交易类型定义
- `types/order.ts` - 基础订单类型

### 业务逻辑
- `lib/trade.ts` - 交易计算和风控逻辑

### 页面组件
- `app/admin/trade/a-share/` - A股审核
- `app/admin/trade/hk-share/` - 港股审核
- `app/admin/trade/ipo/` - 新股申购
- `app/admin/trade/block/` - 大宗交易
- `app/admin/trade/board/` - 一键打板

---

## 数据库表设计

### orders 表
```sql
- id: 订单ID
- user_id: 用户ID
- trade_type: 交易类型 (a-share/hk-share/ipo/block/board)
- symbol: 股票代码
- side: 买卖方向
- quantity: 数量
- price: 价格
- status: 状态
- trade_specific_data: JSON (各类型特有数据)
```

### trade_config 表
```sql
- config_key: 配置键
- config_value: 配置值
- trade_type: 交易类型
```
